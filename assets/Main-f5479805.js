import{g as se,r as c,j as g,a as $,f as Z,T as re,b as ue,c as D,d as ne,Q as ce,e as le}from"./index-cf0e6825.js";import{u as fe,N as de,G as pe,M as he,D as ve}from"./Navbar-9e36a35b.js";var oe={},ae={exports:{}};(function(F){var A=function(b){var M=Object.prototype,O=M.hasOwnProperty,R=Object.defineProperty||function(t,e,r){t[e]=r.value},v,G=typeof Symbol=="function"?Symbol:{},j=G.iterator||"@@iterator",W=G.asyncIterator||"@@asyncIterator",_=G.toStringTag||"@@toStringTag";function S(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{S({},"")}catch{S=function(e,r,o){return e[r]=o}}function Y(t,e,r,o){var n=e&&e.prototype instanceof p?e:p,f=Object.create(n.prototype),x=new I(o||[]);return R(f,"_invoke",{value:H(t,r,x)}),f}b.wrap=Y;function B(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(o){return{type:"throw",arg:o}}}var l="suspendedStart",E="suspendedYield",y="executing",d="completed",s={};function p(){}function h(){}function m(){}var w={};S(w,j,function(){return this});var L=Object.getPrototypeOf,K=L&&L(L(T([])));K&&K!==M&&O.call(K,j)&&(w=K);var U=m.prototype=p.prototype=Object.create(w);h.prototype=m,R(U,"constructor",{value:m,configurable:!0}),R(m,"constructor",{value:h,configurable:!0}),h.displayName=S(m,_,"GeneratorFunction");function ee(t){["next","throw","return"].forEach(function(e){S(t,e,function(r){return this._invoke(e,r)})})}b.isGeneratorFunction=function(t){var e=typeof t=="function"&&t.constructor;return e?e===h||(e.displayName||e.name)==="GeneratorFunction":!1},b.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,S(t,_,"GeneratorFunction")),t.prototype=Object.create(U),t},b.awrap=function(t){return{__await:t}};function Q(t,e){function r(f,x,N,P){var C=B(t[f],t,x);if(C.type==="throw")P(C.arg);else{var u=C.arg,a=u.value;return a&&typeof a=="object"&&O.call(a,"__await")?e.resolve(a.__await).then(function(i){r("next",i,N,P)},function(i){r("throw",i,N,P)}):e.resolve(a).then(function(i){u.value=i,N(u)},function(i){return r("throw",i,N,P)})}}var o;function n(f,x){function N(){return new e(function(P,C){r(f,x,P,C)})}return o=o?o.then(N,N):N()}R(this,"_invoke",{value:n})}ee(Q.prototype),S(Q.prototype,W,function(){return this}),b.AsyncIterator=Q,b.async=function(t,e,r,o,n){n===void 0&&(n=Promise);var f=new Q(Y(t,e,r,o),n);return b.isGeneratorFunction(e)?f:f.next().then(function(x){return x.done?x.value:f.next()})};function H(t,e,r){var o=l;return function(f,x){if(o===y)throw new Error("Generator is already running");if(o===d){if(f==="throw")throw x;return X()}for(r.method=f,r.arg=x;;){var N=r.delegate;if(N){var P=V(N,r);if(P){if(P===s)continue;return P}}if(r.method==="next")r.sent=r._sent=r.arg;else if(r.method==="throw"){if(o===l)throw o=d,r.arg;r.dispatchException(r.arg)}else r.method==="return"&&r.abrupt("return",r.arg);o=y;var C=B(t,e,r);if(C.type==="normal"){if(o=r.done?d:E,C.arg===s)continue;return{value:C.arg,done:r.done}}else C.type==="throw"&&(o=d,r.method="throw",r.arg=C.arg)}}}function V(t,e){var r=e.method,o=t.iterator[r];if(o===v)return e.delegate=null,r==="throw"&&t.iterator.return&&(e.method="return",e.arg=v,V(t,e),e.method==="throw")||r!=="return"&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),s;var n=B(o,t.iterator,e.arg);if(n.type==="throw")return e.method="throw",e.arg=n.arg,e.delegate=null,s;var f=n.arg;if(!f)return e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,s;if(f.done)e[t.resultName]=f.value,e.next=t.nextLoc,e.method!=="return"&&(e.method="next",e.arg=v);else return f;return e.delegate=null,s}ee(U),S(U,_,"Generator"),S(U,j,function(){return this}),S(U,"toString",function(){return"[object Generator]"});function J(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function z(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(J,this),this.reset(!0)}b.keys=function(t){var e=Object(t),r=[];for(var o in e)r.push(o);return r.reverse(),function n(){for(;r.length;){var f=r.pop();if(f in e)return n.value=f,n.done=!1,n}return n.done=!0,n}};function T(t){if(t){var e=t[j];if(e)return e.call(t);if(typeof t.next=="function")return t;if(!isNaN(t.length)){var r=-1,o=function n(){for(;++r<t.length;)if(O.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=v,n.done=!0,n};return o.next=o}}return{next:X}}b.values=T;function X(){return{value:v,done:!0}}return I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=v,this.done=!1,this.delegate=null,this.method="next",this.arg=v,this.tryEntries.forEach(z),!t)for(var e in this)e.charAt(0)==="t"&&O.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=v)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(P,C){return f.type="throw",f.arg=t,e.next=P,C&&(e.method="next",e.arg=v),!!C}for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o],f=n.completion;if(n.tryLoc==="root")return r("end");if(n.tryLoc<=this.prev){var x=O.call(n,"catchLoc"),N=O.call(n,"finallyLoc");if(x&&N){if(this.prev<n.catchLoc)return r(n.catchLoc,!0);if(this.prev<n.finallyLoc)return r(n.finallyLoc)}else if(x){if(this.prev<n.catchLoc)return r(n.catchLoc,!0)}else if(N){if(this.prev<n.finallyLoc)return r(n.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&O.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}}n&&(t==="break"||t==="continue")&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var f=n?n.completion:{};return f.type=t,f.arg=e,n?(this.method="next",this.next=n.finallyLoc,s):this.complete(f)},complete:function(t,e){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&e&&(this.next=e),s},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),z(r),s}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var o=r.completion;if(o.type==="throw"){var n=o.arg;z(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},this.method==="next"&&(this.arg=v),s}},b}(F.exports);try{regeneratorRuntime=A}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=A:Function("r","regeneratorRuntime = r")(A)}})(ae);(function(F){var A=ae.exports;function b(l,E,y,d,s,p,h){try{var m=l[p](h),w=m.value}catch(L){return void y(L)}m.done?E(w):Promise.resolve(w).then(d,s)}function M(l){return function(){var E=this,y=arguments;return new Promise(function(d,s){var p=l.apply(E,y);function h(w){b(p,d,s,h,m,"next",w)}function m(w){b(p,d,s,h,m,"throw",w)}h(void 0)})}}Object.defineProperty(F,"__esModule",{value:!0}),F.default=void 0;var O=!1,R=null,v="en",G=null,j=null,W="https://maps.googleapis.com/maps/api/geocode/json";function _(l){var E=arguments.length>1&&arguments[1]!==void 0&&arguments[1];O&&(E?console.warn(l):console.log(l))}function S(l){return Y.apply(this,arguments)}function Y(){return(Y=M(A.mark(function l(E){var y,d;return A.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,fetch(E).catch(function(){return Promise.reject(new Error("Error fetching data"))});case 2:return y=s.sent,s.next=5,y.json().catch(function(){return _("Error parsing server response"),Promise.reject(new Error("Error parsing server response"))});case 5:if((d=s.sent).status!=="OK"){s.next=9;break}return _(d),s.abrupt("return",d);case 9:return _("".concat(d.error_message,`.
Server returned status code `).concat(d.status),!0),s.abrupt("return",Promise.reject(new Error("".concat(d.error_message,`.
Server returned status code `).concat(d.status))));case 11:case"end":return s.stop()}},l)}))).apply(this,arguments)}var B={setApiKey:function(l){R=l},setLanguage:function(l){v=l},setRegion:function(l){G=l},setLocationType:function(l){j=l},enableDebug:function(){var l=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];O=l},fromLatLng:function(l,E,y,d,s,p){return M(A.mark(function h(){var m,w;return A.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(l&&E){L.next=3;break}return _("Provided coordinates are invalid",!0),L.abrupt("return",Promise.reject(new Error("Provided coordinates are invalid")));case 3:return m="".concat(l,",").concat(E),w="".concat(W,"?latlng=").concat(encodeURIComponent(m)),(y||R)&&(w+="&key=".concat(R=y||R)),(d||v)&&(w+="&language=".concat(v=d||v)),(s||G)&&(G=s||G,w+="&region=".concat(encodeURIComponent(G))),(p||j)&&(j=p||j,w+="&location_type=".concat(encodeURIComponent(j))),L.abrupt("return",S(w));case 9:case"end":return L.stop()}},h)}))()},fromAddress:function(l,E,y,d){return M(A.mark(function s(){var p;return A.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l){h.next=3;break}return _("Provided address is invalid",!0),h.abrupt("return",Promise.reject(new Error("Provided address is invalid")));case 3:return p="".concat(W,"?address=").concat(encodeURIComponent(l)),(E||R)&&(p+="&key=".concat(R=E||R)),(y||v)&&(p+="&language=".concat(v=y||v)),(d||G)&&(G=d||G,p+="&region=".concat(encodeURIComponent(G))),h.abrupt("return",S(p));case 8:case"end":return h.stop()}},s)}))()}};F.default=B})(oe);const q=se(oe);function ye(){q.setApiKey("AIzaSyDWW3NiTjdfwhcLPFux_oOEhfped_Qs3EA"),q.setLanguage("en"),q.setLocationType("ROOFTOP");const{isLoaded:F}=fe({googleMapsApiKey:"AIzaSyDWW3NiTjdfwhcLPFux_oOEhfped_Qs3EA",libraries:["places"]});function A(){const[u,a]=c.exports.useState(null);return c.exports.useEffect(()=>{$.onAuthStateChanged(i=>{i?a(i.uid):_&&a(_.uid)})},[]),u}const b=A(),[M,O]=c.exports.useState(null);function R(){const[u,a]=c.exports.useState(null);return c.exports.useEffect(()=>{$.onAuthStateChanged(i=>{i?Z.collection("users").doc(i.uid).get().then(k=>{a(k.data().FullName),O(k.data().Number)}):a(null)})},[]),u}function v(){const[u,a]=c.exports.useState(null);return c.exports.useEffect(()=>{$.onAuthStateChanged(i=>{i?Z.collection("admin").doc(i.uid).get().then(k=>{a(k.data().FullName)}):a(null)})},[]),u}function G(){const[u,a]=c.exports.useState(null);return c.exports.useEffect(()=>{$.onAuthStateChanged(i=>{i?Z.collection("rider").doc(i.uid).get().then(k=>{a(k.data().FullName)}):a(null)})},[]),u}function j(){const[u,a]=c.exports.useState(null);return c.exports.useEffect(()=>{$.onAuthStateChanged(i=>{i?Z.collection("manager").doc(i.uid).get().then(k=>{a(k.data().FullName)}):a(null)})},[]),u}const W=R(),_=v(),S=G(),Y=j(),B={lat:5.839398,lng:-55.199089},[l,E]=c.exports.useState(null),[y,d]=c.exports.useState(null),[s,p]=c.exports.useState(""),[h,m]=c.exports.useState(""),[w,L]=c.exports.useState(""),[K,U]=c.exports.useState(""),[ee,Q]=c.exports.useState(""),[H,V]=c.exports.useState(""),[J,z]=c.exports.useState("");c.exports.useState(""),c.exports.useState("");let I=c.exports.useRef(),T=c.exports.useRef();function X(){d(null),p(""),m(""),L(""),U(""),Q(""),V(""),z(""),T.current.value="",I.current.value=""}const t=()=>{var u,a;u=new google.maps.Map(document.getElementById("map"),{center:{lat:5.839398,lng:-55.199089},zoom:18}),a=new google.maps.InfoWindow,new google.maps.InfoWindow,new google.maps.Geocoder,navigator.geolocation?navigator.geolocation.getCurrentPosition(function(i){var k={lat:i.coords.latitude,lng:i.coords.longitude};a.setPosition(k),a.setContent("Location found."),a.open(u),u.setCenter(k),L(i.coords.latitude+","),U(i.coords.longitude),q.fromLatLng(i.coords.latitude,i.coords.longitude).then(te=>{const ie=te.results[0].formatted_address;V(ie)},te=>{console.error(te)})},function(){e(!0,a,u.getCenter())}):e(!1,a,u.getCenter()),q.fromLatLng(position.coords.latitude,position.coords.longitude).then(i=>{i.results[0].formatted_address},i=>{console.error(i)})};function e(u,a){infoWindow.setPosition(a),infoWindow.setContent(u?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation."),infoWindow.open(l)}window.initMap=t;const[r,o]=c.exports.useState([]);c.exports.useEffect(()=>{(async()=>{const a=re(ne,"client");ue(a,i=>{o(i.docs.map(k=>({...k.data(),id:k.id})))})})()},[]);const n=()=>r.map(u=>{if(u.client==="client pickedup")return null;if(u.clientId===b)return g("div",{children:D("p",{children:[" ",u.client," "]})})}),f=()=>{const u=c.exports.useRef();T=c.exports.useRef();const a={componentRestrictions:{country:"sr"}};return c.exports.useEffect(()=>{u.current=new window.google.maps.places.Autocomplete(T.current,a)},[]),D("div",{className:"displayflex",children:[g("input",{id:"input",className:"client-input",type:"text",placeholder:"from",defaultValue:H,ref:T,onBlur:i=>V(i.target.value)}),g("input",{type:"text",className:"client-input",placeholder:"name ",defaultValue:W}),g("input",{type:"text",className:"client-input",placeholder:"number ",defaultValue:M})]})},x=()=>{const u=c.exports.useRef();I=c.exports.useRef();const a={componentRestrictions:{country:"sr"}};return c.exports.useEffect(()=>{u.current=new window.google.maps.places.Autocomplete(I.current,a)},[]),g("div",{children:g("input",{type:"text",className:"client-input",placeholder:"to",ref:I,defaultValue:J,onBlur:i=>z(i.target.value)})})};async function N(){if(T.current.value===""||I.current.value==="")return;const a=await new google.maps.DirectionsService().route({origin:T.current.value,destination:I.current.value,travelMode:google.maps.TravelMode.DRIVING});d(a),p(a.routes[0].legs[0].distance.text),m(a.routes[0].legs[0].duration.text),V(T.current.value),z(I.current.value);const i=re(ne,"test");ce(i,{name:W,start:H,end:J,distance:a.routes[0].legs[0].distance.text,duration:a.routes[0].legs[0].duration.text,number:M,client:b,status:"client waiting",taken:"not yet taken",timestamp:le()}).then(()=>{d(null),p(""),m(""),L(""),U(""),Q(""),V(""),z(""),T.current.value="",I.current.value=""})}function P(u){u.preventDefault()}function C(){if(Y||W||_||S)return D("div",{className:"client-whole-div",children:[g(de,{user:W,admin:_,riders:S,manager:Y}),D(pe,{id:"map",zoom:12,center:B,mapContainerClassName:"map-container client-map",children:[g(he,{}),y&&g(ve,{directions:y})]}),D("div",{className:"client-status",children:[" ",g(n,{})]}),D("form",{onSubmit:P,className:"form-things",children:[g(f,{}),g(x,{}),g("button",{onClick:N,children:" confirm ride "}),g("button",{onClick:X,children:" del route "})]}),D("div",{className:"client-find-me",children:[D("div",{className:"client-span",children:[D("p",{children:["Distance: ",s]}),D("p",{children:[" Duration:",h]})]}),g("button",{id:"button",className:"map-btn ",onClick:()=>t(),children:" find me "}),g("div",{id:"reverse"})]})]})}if(!F)return g("div",{children:" loading .... "});if(F)return g("div",{children:g(C,{})})}export{ye as default};
