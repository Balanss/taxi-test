import{g as ue,r as c,j as w,a as X,f as te,T as ne,b as ce,c as U,d as oe,Q as le,e as fe}from"./index-c166a26e.js";import{u as de,N as pe,G as he,M as ve,D as me}from"./Navbar-b1695df9.js";var ae={},ie={exports:{}};(function(M){var O=function(S){var W=Object.prototype,j=W.hasOwnProperty,R=Object.defineProperty||function(t,e,r){t[e]=r.value},v,C=typeof Symbol=="function"?Symbol:{},G=C.iterator||"@@iterator",D=C.asyncIterator||"@@asyncIterator",k=C.toStringTag||"@@toStringTag";function E(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{E({},"")}catch{E=function(e,r,a){return e[r]=a}}function Y(t,e,r,a){var n=e&&e.prototype instanceof g?e:g,l=Object.create(n.prototype),L=new ee(a||[]);return R(l,"_invoke",{value:Q(t,r,L)}),l}S.wrap=Y;function V(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(a){return{type:"throw",arg:a}}}var f="suspendedStart",y="suspendedYield",m="executing",d="completed",i={};function g(){}function p(){}function b(){}var h={};E(h,G,function(){return this});var A=Object.getPrototypeOf,F=A&&A(A(I([])));F&&F!==W&&j.call(F,G)&&(h=F);var z=b.prototype=g.prototype=Object.create(h);p.prototype=b,R(z,"constructor",{value:b,configurable:!0}),R(b,"constructor",{value:p,configurable:!0}),p.displayName=E(b,k,"GeneratorFunction");function $(t){["next","throw","return"].forEach(function(e){E(t,e,function(r){return this._invoke(e,r)})})}S.isGeneratorFunction=function(t){var e=typeof t=="function"&&t.constructor;return e?e===p||(e.displayName||e.name)==="GeneratorFunction":!1},S.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,E(t,k,"GeneratorFunction")),t.prototype=Object.create(z),t},S.awrap=function(t){return{__await:t}};function B(t,e){function r(l,L,x,_){var N=V(t[l],t,L);if(N.type==="throw")_(N.arg);else{var J=N.arg,s=J.value;return s&&typeof s=="object"&&j.call(s,"__await")?e.resolve(s.__await).then(function(o){r("next",o,x,_)},function(o){r("throw",o,x,_)}):e.resolve(s).then(function(o){J.value=o,x(J)},function(o){return r("throw",o,x,_)})}}var a;function n(l,L){function x(){return new e(function(_,N){r(l,L,_,N)})}return a=a?a.then(x,x):x()}R(this,"_invoke",{value:n})}$(B.prototype),E(B.prototype,D,function(){return this}),S.AsyncIterator=B,S.async=function(t,e,r,a,n){n===void 0&&(n=Promise);var l=new B(Y(t,e,r,a),n);return S.isGeneratorFunction(e)?l:l.next().then(function(L){return L.done?L.value:l.next()})};function Q(t,e,r){var a=f;return function(l,L){if(a===m)throw new Error("Generator is already running");if(a===d){if(l==="throw")throw L;return T()}for(r.method=l,r.arg=L;;){var x=r.delegate;if(x){var _=q(x,r);if(_){if(_===i)continue;return _}}if(r.method==="next")r.sent=r._sent=r.arg;else if(r.method==="throw"){if(a===f)throw a=d,r.arg;r.dispatchException(r.arg)}else r.method==="return"&&r.abrupt("return",r.arg);a=m;var N=V(t,e,r);if(N.type==="normal"){if(a=r.done?d:y,N.arg===i)continue;return{value:N.arg,done:r.done}}else N.type==="throw"&&(a=d,r.method="throw",r.arg=N.arg)}}}function q(t,e){var r=e.method,a=t.iterator[r];if(a===v)return e.delegate=null,r==="throw"&&t.iterator.return&&(e.method="return",e.arg=v,q(t,e),e.method==="throw")||r!=="return"&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),i;var n=V(a,t.iterator,e.arg);if(n.type==="throw")return e.method="throw",e.arg=n.arg,e.delegate=null,i;var l=n.arg;if(!l)return e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,i;if(l.done)e[t.resultName]=l.value,e.next=t.nextLoc,e.method!=="return"&&(e.method="next",e.arg=v);else return l;return e.delegate=null,i}$(z),E(z,k,"Generator"),E(z,G,function(){return this}),E(z,"toString",function(){return"[object Generator]"});function K(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function H(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function ee(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(K,this),this.reset(!0)}S.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function n(){for(;r.length;){var l=r.pop();if(l in e)return n.value=l,n.done=!1,n}return n.done=!0,n}};function I(t){if(t){var e=t[G];if(e)return e.call(t);if(typeof t.next=="function")return t;if(!isNaN(t.length)){var r=-1,a=function n(){for(;++r<t.length;)if(j.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=v,n.done=!0,n};return a.next=a}}return{next:T}}S.values=I;function T(){return{value:v,done:!0}}return ee.prototype={constructor:ee,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=v,this.done=!1,this.delegate=null,this.method="next",this.arg=v,this.tryEntries.forEach(H),!t)for(var e in this)e.charAt(0)==="t"&&j.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=v)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(_,N){return l.type="throw",l.arg=t,e.next=_,N&&(e.method="next",e.arg=v),!!N}for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a],l=n.completion;if(n.tryLoc==="root")return r("end");if(n.tryLoc<=this.prev){var L=j.call(n,"catchLoc"),x=j.call(n,"finallyLoc");if(L&&x){if(this.prev<n.catchLoc)return r(n.catchLoc,!0);if(this.prev<n.finallyLoc)return r(n.finallyLoc)}else if(L){if(this.prev<n.catchLoc)return r(n.catchLoc,!0)}else if(x){if(this.prev<n.finallyLoc)return r(n.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&j.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var n=a;break}}n&&(t==="break"||t==="continue")&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var l=n?n.completion:{};return l.type=t,l.arg=e,n?(this.method="next",this.next=n.finallyLoc,i):this.complete(l)},complete:function(t,e){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&e&&(this.next=e),i},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),H(r),i}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if(a.type==="throw"){var n=a.arg;H(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:I(t),resultName:e,nextLoc:r},this.method==="next"&&(this.arg=v),i}},S}(M.exports);try{regeneratorRuntime=O}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=O:Function("r","regeneratorRuntime = r")(O)}})(ie);(function(M){var O=ie.exports;function S(f,y,m,d,i,g,p){try{var b=f[g](p),h=b.value}catch(A){return void m(A)}b.done?y(h):Promise.resolve(h).then(d,i)}function W(f){return function(){var y=this,m=arguments;return new Promise(function(d,i){var g=f.apply(y,m);function p(h){S(g,d,i,p,b,"next",h)}function b(h){S(g,d,i,p,b,"throw",h)}p(void 0)})}}Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var j=!1,R=null,v="en",C=null,G=null,D="https://maps.googleapis.com/maps/api/geocode/json";function k(f){var y=arguments.length>1&&arguments[1]!==void 0&&arguments[1];j&&(y?console.warn(f):console.log(f))}function E(f){return Y.apply(this,arguments)}function Y(){return(Y=W(O.mark(function f(y){var m,d;return O.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,fetch(y).catch(function(){return Promise.reject(new Error("Error fetching data"))});case 2:return m=i.sent,i.next=5,m.json().catch(function(){return k("Error parsing server response"),Promise.reject(new Error("Error parsing server response"))});case 5:if((d=i.sent).status!=="OK"){i.next=9;break}return k(d),i.abrupt("return",d);case 9:return k("".concat(d.error_message,`.
Server returned status code `).concat(d.status),!0),i.abrupt("return",Promise.reject(new Error("".concat(d.error_message,`.
Server returned status code `).concat(d.status))));case 11:case"end":return i.stop()}},f)}))).apply(this,arguments)}var V={setApiKey:function(f){R=f},setLanguage:function(f){v=f},setRegion:function(f){C=f},setLocationType:function(f){G=f},enableDebug:function(){var f=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];j=f},fromLatLng:function(f,y,m,d,i,g){return W(O.mark(function p(){var b,h;return O.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(f&&y){A.next=3;break}return k("Provided coordinates are invalid",!0),A.abrupt("return",Promise.reject(new Error("Provided coordinates are invalid")));case 3:return b="".concat(f,",").concat(y),h="".concat(D,"?latlng=").concat(encodeURIComponent(b)),(m||R)&&(h+="&key=".concat(R=m||R)),(d||v)&&(h+="&language=".concat(v=d||v)),(i||C)&&(C=i||C,h+="&region=".concat(encodeURIComponent(C))),(g||G)&&(G=g||G,h+="&location_type=".concat(encodeURIComponent(G))),A.abrupt("return",E(h));case 9:case"end":return A.stop()}},p)}))()},fromAddress:function(f,y,m,d){return W(O.mark(function i(){var g;return O.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(f){p.next=3;break}return k("Provided address is invalid",!0),p.abrupt("return",Promise.reject(new Error("Provided address is invalid")));case 3:return g="".concat(D,"?address=").concat(encodeURIComponent(f)),(y||R)&&(g+="&key=".concat(R=y||R)),(m||v)&&(g+="&language=".concat(v=m||v)),(d||C)&&(C=d||C,g+="&region=".concat(encodeURIComponent(C))),p.abrupt("return",E(g));case 8:case"end":return p.stop()}},i)}))()}};M.default=V})(ae);const Z=ue(ae);function ye(){Z.setApiKey("AIzaSyDWW3NiTjdfwhcLPFux_oOEhfped_Qs3EA"),Z.setLanguage("en"),Z.setLocationType("ROOFTOP");const{isLoaded:M}=de({googleMapsApiKey:"AIzaSyDWW3NiTjdfwhcLPFux_oOEhfped_Qs3EA",libraries:["places"]});function O(){const[s,o]=c.exports.useState(null);return c.exports.useEffect(()=>{X.onAuthStateChanged(u=>{u?o(u.uid):D&&o(D.uid)})},[]),s}O();const[S,W]=c.exports.useState(null);function j(){const[s,o]=c.exports.useState(null);return c.exports.useEffect(()=>{X.onAuthStateChanged(u=>{u?te.collection("users").doc(u.uid).get().then(P=>{o(P.data().FullName),W(P.data().Number)}):o(null)})},[]),s}function R(){const[s,o]=c.exports.useState(null);return c.exports.useEffect(()=>{X.onAuthStateChanged(u=>{u?te.collection("admin").doc(u.uid).get().then(P=>{o(P.data().FullName)}):o(null)})},[]),s}function v(){const[s,o]=c.exports.useState(null);return c.exports.useEffect(()=>{X.onAuthStateChanged(u=>{u?te.collection("rider").doc(u.uid).get().then(P=>{o(P.data().FullName)}):o(null)})},[]),s}function C(){const[s,o]=c.exports.useState(null);return c.exports.useEffect(()=>{X.onAuthStateChanged(u=>{u?te.collection("manager").doc(u.uid).get().then(P=>{o(P.data().FullName)}):o(null)})},[]),s}const G=j(),D=R(),k=v(),E=C(),Y={lat:5.839398,lng:-55.199089},[V,f]=c.exports.useState(null),[y,m]=c.exports.useState(null),[d,i]=c.exports.useState(""),[g,p]=c.exports.useState(""),[b,h]=c.exports.useState(""),[A,F]=c.exports.useState(""),[z,$]=c.exports.useState(""),[B,Q]=c.exports.useState(""),[q,K]=c.exports.useState("");c.exports.useState("");const[H,ee]=c.exports.useState("");let I=c.exports.useRef(),T=c.exports.useRef();function t(){m(null),i(""),p(""),h(""),F(""),$(""),Q(""),K(""),T.current.value="",I.current.value=""}const e=()=>{var s,o;s=new google.maps.Map(document.getElementById("map"),{center:{lat:5.839398,lng:-55.199089},zoom:18}),o=new google.maps.InfoWindow,new google.maps.InfoWindow,new google.maps.Geocoder,navigator.geolocation?navigator.geolocation.getCurrentPosition(function(u){var P={lat:u.coords.latitude,lng:u.coords.longitude};o.setPosition(P),o.setContent("Location found."),o.open(s),s.setCenter(P),h(u.coords.latitude+","),F(u.coords.longitude),Z.fromLatLng(u.coords.latitude,u.coords.longitude).then(re=>{const se=re.results[0].formatted_address;Q(se)},re=>{console.error(re)})},function(){r(!0,o,s.getCenter())}):r(!1,o,s.getCenter()),Z.fromLatLng(position.coords.latitude,position.coords.longitude).then(u=>{u.results[0].formatted_address},u=>{console.error(u)})};function r(s,o){infoWindow.setPosition(o),infoWindow.setContent(s?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation."),infoWindow.open(V)}window.initMap=e;const[a,n]=c.exports.useState([]);c.exports.useEffect(()=>{(async()=>{const o=ne(oe,"client");ce(o,u=>{n(u.docs.map(P=>({...P.data(),id:P.id})))})})()},[]);const l=()=>a.map(s=>s.client==="client pickedup"?null:w("div",{children:U("p",{children:[" ",s.client," "]})})),L=()=>{const s=c.exports.useRef();T=c.exports.useRef();const o={componentRestrictions:{country:"sr"}};return c.exports.useEffect(()=>{s.current=new window.google.maps.places.Autocomplete(T.current,o)},[]),U("div",{className:"displayflex",children:[w("input",{id:"input",className:"client-input",type:"text",placeholder:"from",defaultValue:B,ref:T,onBlur:u=>Q(u.target.value)}),w("input",{type:"text",className:"client-input",placeholder:"name ",defaultValue:G}),w("input",{type:"text",className:"client-input",placeholder:"number ",defaultValue:S})]})},x=()=>{const s=c.exports.useRef();I=c.exports.useRef();const o={componentRestrictions:{country:"sr"}};return c.exports.useEffect(()=>{s.current=new window.google.maps.places.Autocomplete(I.current,o)},[]),w("div",{children:w("input",{type:"text",className:"client-input",placeholder:"to",ref:I,defaultValue:q,onBlur:u=>K(u.target.value)})})};async function _(){if(T.current.value===""||I.current.value==="")return;const o=await new google.maps.DirectionsService().route({origin:T.current.value,destination:I.current.value,travelMode:google.maps.TravelMode.DRIVING});m(o),i(o.routes[0].legs[0].distance.text),p(o.routes[0].legs[0].duration.text),Q(T.current.value),K(I.current.value);const u=ne(oe,"test");le(u,{name:G,start:B,end:q,distance:o.routes[0].legs[0].distance.text,duration:o.routes[0].legs[0].duration.text,number:H,status:"client waiting",timestamp:fe()}).then(()=>{m(null),i(""),p(""),h(""),F(""),$(""),Q(""),K(""),T.current.value="",I.current.value=""})}function N(s){s.preventDefault()}function J(){if(E||G||D||k)return U("div",{className:"client-whole-div",children:[w(pe,{user:G,admin:D,riders:k,manager:E}),U(he,{id:"map",zoom:12,center:Y,mapContainerClassName:"map-container client-map",children:[w(ve,{}),y&&w(me,{directions:y})]}),U("div",{className:"client-status",children:[" ",w(l,{})]}),U("form",{onSubmit:N,className:"form-things",children:[w(L,{}),w(x,{}),w("button",{onClick:_,children:" confirm ride "}),w("button",{onClick:t,children:" del route "})]}),U("div",{className:"client-find-me",children:[U("div",{className:"client-span",children:[U("p",{children:["Distance: ",d]}),U("p",{children:[" Duration:",g]})]}),w("button",{id:"button",className:"map-btn ",onClick:()=>e(),children:" find me "}),w("div",{id:"reverse"})]})]})}if(!M)return w("div",{children:" loading .... "});if(M)return w("div",{children:w(J,{})})}export{ye as default};
